# コントラスト比

文字の色と背景色との相対的な明るさ（相対輝度）の差を示した比率。
文字の色・背景色のコントラスト比の数値が一定基準に達しているかどうかで `AA` `AAA` 等の判定度を計る事ができる。

> **Web Content Accessibility Guidelines (WCAG) 2.0**
> アクセシビリティのためのガイドライン

トーンは特に重要ではない。
トーンによって区別されていても、色覚異常の人にとって区別の材料とならない事がある。
（同じトーンの緑と赤がグレーの濃淡にしか見えないケースがある）

note:

- 目視で確認するのではなくコントラスト比は常に数値で算出する

## 画像内のテキスト

画像内のテキストにもコントラスト比のガイドラインは適用される。
ただし画像内のテキストはスクリーンリーダーがテキストを検出できないため alt 属性を付ける事を勧める。

## プレースホルダ

プレースホルダにもガイドラインは適用される。
ただしプレースホルダは別の問題としてアクセシビリティの課題を抱えている。

## コントラスト比の例外

- 企業のロゴ
- ボットチェック画像の装飾テキスト
- 画像内の道路標識
- disabledなテキスト

## UI パーツ

`<input>` `<button>` などのフォームのパーツもコントラスト比のガイドラインを考慮したほうが良い。
背景色と `<input>` 線のコントラスト比が `1.5:1` のケースでは視覚障害のある人がそのパーツを見つけるのが困難になるかもしれない。

また、ボタンには「OK」のような単語でなく具体的なテキストを示したほうが良い。

タブリストについて、開始位置と終了位置を明確にする事は優れたスタイルのため、アクティブなタブおよびそのコンテンツの境界をコントラスト比の高い線で示す事は優良である。

ボタンについて、フォームの入力に誤りがあり `submit` できない事を示すケースでは、その状態を示す事を考慮する事。
`disabled` にするのも手段のひとつ、そして `readonly` と混同しない事。

## グラフィカルオブジェクト

グラフ、アイコンなど。
コントラスト比を考慮する事が必要。
またコントラスト比だけでなく、不要なグリッド線を排除し数値のラベルを追加するなどデザインを工夫する余地もある。

## 色だけで表現できないもの

白背景に青・濃いグレーはコントラスト比は十分なものの、この２色でアクティブなページとそれ以外をタブナビゲーションで表現するのは不十分である。
背景・前景のコントラスト比が同じである場合、グレースケールで前景がほぼ同じグレーで表現されてしまう。
その場合、太字や下線で工夫する。

# セマンティクス

HTMLはマークアップ言語である。単なるプレーンテキストでなく意味を持たせたマークアップを行う事ををセマンティクスと呼ぶ。
HTMLが単なる `<div>` `<span>` の列挙になっていないか？

## 見出しには `<h1>` `<h2>` を用いる

スクリーンリーダーがコンテンツと共に `heading level` を伝える。

## 構造要素

HTML5で導入された構造を示す要素。

- `<header>`
- `<navigation>`
- `<main>`
- `<footer>`

## セマンティクスが失われる問題

`font-size: 1px` `color:blue` など視覚的に要素に差をつけてもスクリーンリーダーはそれを考慮しない。
これらを使うのではなく意味のある構造にしなければならない。

SEOを意識して全てを `<h1>` で配置し `<h1 class="h2">` のように外観で構造を表現するのは間違い。

## 構文を間違えない

タグの閉じ忘れ、`<tr>` に属さない `<td>` などがあってもブラウザは外観を補正してしまう。
スクリーンリーダーはHTMLコードに依存するため、ブラウザの補正に頼らず正しい構文で記述すること。

## カスタム機能より意味論を重視する

`<span class="link">` のようにして Anchor と同じ機能を持たせた場合、一部のスクリーンリーダーはクリック可能である事を読み上げるかもしれない。
ただし `<a>` を用いた時とは異なり「リンク」の意味が失われてしまう。

HTML の標準に忠実にコーディングする事、そうする事でカスタムに勝る意味論を表現する事ができる。

radio を使ったタブリストの例：
タブはひとつしか選択できない事を表現する。
`<fieldset>` がひとまとまりの部品を表現する。

```html
<div class="tablist">
  <fieldset>
    <legend>Tablist controls</legend>
    <input type="radio" name="tablist" value="dancing" id="dancing_label" checked />
    <label for="dancing_label">Dancing</label>

    <input type="radio" name="tablist" value="soccer" id="soccer_label" />
    <label for="soccer_label">Soccer</label>
  </fieldset>

  <div id="dancing_panel">...</div>
  <div id="soccer_panel" hidden>...</div>
</div>
```

# ARIA

HTML標準だけでは機能を表現しきれないため、その属性を追加するために作られた。
タブリスト・ドロップダウン・オートコンプリートなど。

## role

`role="button"` など意味のあるロールを表現する。

## aria-*

`role` で表現したロールにステータスを付け加える。
`<span role="button" aria-pressed="true">` など。

> **role** と **aria** の一覧
> https://www.w3.org/TR/wai-aria-1.1/#tablist

## ARIA の問題

ARIA はスクリーンリーダーによって差異があり完璧に動作するとは言えない。
現段階で ARIA だけを頼ってアクセシビリティを向上させるのはお勧めしない。

### role で解決できない問題

例えば：

```html
<span class="link" onclick="..." role="link">
  Google
</span>
```

古いスクリーンリーダーは `role="link"` をサポートしていない、また `<span>` はフォーカスできない、カスタムのjavascriptを必要とするなどの問題がある。
これに対する良い解決策は HTML 標準の `<a>` を用いる事。

### 冗長

```html
<form role="form">
  ...
</form>

<a href="..." role="link">
  Google
</a>
```

このような過剰な意味づけをするとスクリーンリーダーはバグを起こすらしい。

## ARIA でラベル付けする例

下記の例は画像でユーザーをナビゲートするため、スクリーンリーダーがリンクである事を認識できない。

```html
<a class="cart"></a>

<style>
a.cart {
  background: url("cart.png");
}
</style>
```

`aria-label` を用いる事でスクリーンリーダーはリンクである事を認識する。

```html
<a class="cart" aria-label="Shopping cart"></a>

<style>
a.cart {
  background: url("cart.png");
}
</style>
```

ただしこれには下記のような問題がある。

- テキストブラウザは画像が表示されない
- レガシーなスクリーンリーダーは ARIA の互換性がない
- ネットワークの問題がある時、画像が表示されない
- テキスト検索が ARIA のラベルに一致しない

堅牢にコーディングするには HTML によって構造を示す事がポイントとなる。

```html
<a class="cart">
  <span class="visually-hidden">Shopping cart</span>
</a>
```

また `alt` を用いてネットワークに問題があるケースでもユーザーに意図を伝える事。

```html
<a class="cart">
  <img src="cart.png" alt="Shopping cart" />
</a>
```

下記は少し冗長に感じられるかもしれないが、情報が少ないよりも冗長な情報が少しあるほうが良い。

```html
<a class="cart">
  <img src="cart.png" alt="Shopping cart" />
  <span class="visually-hidden">Shopping cart</span>
</a>
```

ARIA を用いてラベルを追加する事は、一般のユーザーと障害のあるユーザーを異なる方法で扱う事であり、ベストな解決策ではない。

## 一部のユーザーの扱いを変える事

ズーム機能はスクリーンリーダーのユーザーにとって意味のない機能であるとラベルを用いて伝える例。

```html
<button aria-label="Dear screen reader user, please do not use this functionality, it is not meant for you">
  Zoom image
</button>
```

ユニバーサルデザインでは機能は全てのユーザーにとって同じであるべきと定められている。
スクリーンリーダーのユーザーは意外かもしれないがズーム機能を使っていて、開発者の思い込みで一般のユーザーと障害のあるユーザーへの機能を区別するべきではない。

また開発者の思い込みでフォーカスされた要素を `aria-hidden` で隠蔽するケースが見受けられる。
`aria-hidden` の要素にもブラウザは tab でフォーカス移動するが、スクリーンリーダーがそれを読み上げる事ができないという問題がある。

# キーボード操作

タッチ操作やポインティングデバイスを利用できないユーザーのためにキーボードで操作を完遂できる事を考慮する。
キーボードを使用できないユーザーのために代替デバイスが存在するため、キーボードでの操作の完遂は有用である。

Windows を例にすると、メニュー項目には `Select all...Ctrl + A` のようなキーボード操作が存在する。
また先頭文字に下線が引かれているメニュー項目はショートカットキーによりその項目にアクセスできる事を意味する。

これは特定グループ向け（運動障害など）にサイトを最適化し、他のグループ向け（パワーユーザー）にサイトを最適化する良い例。
運動障害のあるユーザーは少ないキー操作で項目にアクセスする事ができ、またパワーユーザーにとっても高速に機能を利用できる。

Web サイトの例：

- タブナビゲーションを `Tab` で移動する
- `Shift + Tab` で逆方向に移動する
- `Enter` で決定する
- `Space` でオープン・クローズなどステートをトグルする
- 矢印キーで項目を移動する
- `Esc` でプロンプトなどを閉じる

標準の HTML はキーボード操作をサポートするため、特別なキー操作の考慮は必要ない。

- 要素がフォーカス可能かどうかを確認する
- `<div tabindex="0">` などでフォーカスを与える
- `<a>` は `href` 属性が与えられた時のみフォーカス可能な挙動をする

必要に応じて `onClick` を実装する。

- どのブラウザでも動作可能にする事
- マウスクリックや `Enter` キーがトリガーになる
- よく使われる `hover` はマウス操作にしか反応しないためそれだけに頼るとドロップダウンなどの開閉が一部のユーザーに限定されてしまう
- キーコード `13` だけに反応するような処理はスクリーンリーダーの `Enter` をキャッチできないため `onClick` のほうが有用
- `Alt` や矢印キーなど特定のデバイスに存在しないキーに依存しない事
- キーの組み合わせは運動障害のある人が押すことが難しい
- ダイアログを開いた時はカレントのコンテンツを示すためフォーカスを与える事
- ダイアログについては閉じるボタンを最初の要素として定義する事が望ましい
- ダイアログが開いた時にフォーカスが背景コンテンツに存在したままにするのはパワーユーザーにとっても望ましくない
- ダイアログが閉じた時は直前の操作にフォーカスを当てる事

# Example

## lang を設定する

スクリーンリーダーに正しく認識させるため。

## title を設定する

ページがロードされた時にスクリーンリーダーが読み上げる。
「お問い合わせフォーム ACME Inc.」のようにどのサイトに属するのかサイトの名前を追加する事を忘れないようにする。

`alert` ロールを使うと「送信に失敗」や「入力項目に誤りがある」などのアラートをユーザーに伝える事ができる。

## viewport

デバイス幅に設定しズームスケールを1にする事。

## hidden

スクリーンリーダーとビジュアルブラウザの両方から非表示にするには `.visually-hidden { left: -10000px }` などを用いて viewport の外に出す事。
フォーカスを得た時に画面に要素が現れる事を確認する。

ビジュアルブラウザでは認知可能でスクリーンリーダーは無視する設定は ARIA で簡単に実装できるがフォーカス可能な要素に適用してはいけない。

`hidden` 属性はどのデバイスからも完全に見えなくする事ができる。
または CSS の `visibility:hidden` でも同じ。
コンテンツとプレゼンテーションの見た目を切り分けるため `hidden` を使ってコンテンツで解決するほうがベター。

## 見出し

- `H` で次の見出しにジャンプする
- `1 - 6` 見出しを移動する

スクリーンリーダーは見出しのラベルを読み上げる。

ここから
https://www.accessibility-developer-guide.com/examples/headings/good-example/
