{"ast":null,"code":"var _TopComponent_posts$;\n\nimport { __classPrivateFieldGet } from \"tslib\";\nimport { map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@scullyio/ng-lib\";\nimport * as i2 from \"src/app/services/tag-selector\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"src/app/components/tag/tag.component\";\nimport * as i6 from \"../../pipes/tags-match.pipe\";\nimport * as i7 from \"src/app/pipes/split-tag.pipe\";\n\nfunction TopComponent_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵelementStart(1, \"time\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"a\", 2);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(6, \"tag\", 3);\n    i0.ɵɵpipe(7, \"splitTag\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const post_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(3, 4, post_r1.updatedAt, \"yyyy-MM-dd\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", post_r1.route);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(post_r1.title);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"tags\", i0.ɵɵpipeBind1(7, 7, post_r1.tags));\n  }\n}\n\nexport class TopComponent {\n  constructor(scully, tagSelector) {\n    this.scully = scully;\n    this.tagSelector = tagSelector;\n    this.posts = [];\n    this.tags = [];\n\n    _TopComponent_posts$.set(this, this.scully.available$.pipe(map(posts => posts.filter(v => v.route !== '/')), map(posts => this.sortBy(posts, 'updatedAt'))));\n  }\n\n  ngOnInit() {\n    this.tagSelector.watch().subscribe(tags => this.tags = tags.filter(tag => tag.isSelected).map(tag => tag.tag));\n\n    __classPrivateFieldGet(this, _TopComponent_posts$, \"f\").subscribe(posts => {\n      this.posts = posts;\n      this.tagSelector.load(posts);\n    });\n  }\n\n  sortBy(posts, field) {\n    return posts.sort((a, b) => {\n      if (a[field] > b[field]) {\n        return -1;\n      }\n\n      if (a[field] < b[field]) {\n        return 1;\n      }\n\n      return 0;\n    });\n  }\n\n}\n_TopComponent_posts$ = new WeakMap();\n\nTopComponent.ɵfac = function TopComponent_Factory(t) {\n  return new (t || TopComponent)(i0.ɵɵdirectiveInject(i1.ScullyRoutesService), i0.ɵɵdirectiveInject(i2.TagSelector));\n};\n\nTopComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: TopComponent,\n  selectors: [[\"app-top\"]],\n  decls: 3,\n  vars: 4,\n  consts: [[\"role\", \"list\"], [4, \"ngFor\", \"ngForOf\"], [3, \"routerLink\"], [3, \"tags\"]],\n  template: function TopComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"ul\", 0);\n      i0.ɵɵtemplate(1, TopComponent_li_1_Template, 8, 9, \"li\", 1);\n      i0.ɵɵpipe(2, \"tagsMatch\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind2(2, 1, ctx.posts, ctx.tags));\n    }\n  },\n  directives: [i3.NgForOf, i4.RouterLinkWithHref, i5.TagComponent],\n  pipes: [i6.TagsMatchPipe, i3.DatePipe, i7.SplitTagPipe],\n  styles: [\"\"]\n});","map":null,"metadata":{},"sourceType":"module"}